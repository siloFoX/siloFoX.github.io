---
layout: post
title:  "AI framework Development 8"
date:   2020-09-10
excerpt: "요구사항에 맞게 데이터 가공"
tag:
- AI
- framework
- blog
- silofox
comments: true
feature: https://github.com/siloFoX/siloFoX.github.io/blob/master/images/help/help.jpg?raw=true
---

test commit

공모전 기간이 생각보다 빡빡하기 때문에 서두르는게 좋을 것 같다.<br>
함수화 시키는 것도 슬슬 생각하는 것이 좋을 것 같다.

7에 있는 요구사항에 맞춰서 데이터를 생성한다.

```
    death: {
        from: "2020-01-01",
        to: "2020-09-08"
		global: {
			data : [
				1,
				1,
				// 이하 일별 사망자 수
			]
			//이하 35개국 데이터
		},
	},

	confirmed: {
		from: "2020-01-01",
		to: "2020-09-08",
		global: {
			data : [
				1,
				1,
				// 이하 일별 확진자 수
			]
			//이하 35개국 확진자 데이터
		},
	}
```

<br>

# 전체 확진자와 사망자

who 데이터 특성상 나라별, 날짜별로 데이터가 있다.<br>
그에 따른 이슈는

1. 전 세계 데이터를 구하려면 나라별 데이터를 전부 더해야 한다.
2. 데이터가 0 명일 때 데이터까지 있지는 않다. 나라별로 코로나 발병한 날짜부터 카운팅된다. 그래서 더미 1월 1일 부터 없는 날에는 더미데이터를 넣어야 한다.

일단 global 데이터부터 구하는데 2는 무시하고 구해본다.<br>
그리고 함수화 시킨다.

<br>

## Global 데이터

다행히 map reduce pattern 을 지원해서 Date 를 기준으로 숫자들을 집계할 수 있었다.<br>
문제는 일별로 데이터를 mapping 해주는게 필요해졌다는 것이다.<br>
로직으로 말하자.

전제 : YYYY-MM-DD 포멧이다, 시작한 날짜부터는 계속 Serialized data가 이어진다.

1. 날짜에 맞는 데이터가 존재하는지 확인한다.
2. YYYY-MM-DD 포멧의 데이터를 2020-01-01 을 기준으로 일당 0.01 으로 Serialize 한다.
3. DataFrame에 맞춰 넣는다. scale에 맞춘 데이터를 확인한 후 추출한다.

Date mapping
```
1월 1일 : 0.01
1월 31일 : 0.31

2월 1일 : 0.31 + 0.01 = 0.32
2월 29일 : 0.31 + 0.29 = 0.60

3월 1일 : 0.60 + 0.01 = 0.61
3월 31일 : 0.60 + 0.31 = 0.91

4월 1일 : 0.91 + 0.01 = 0.92
4월 30일 : 0.91 + 0.30 = 1.21 

5월 1일 : 1.21 + 0.01 = 1.22
5월 31일 : 1.21 + 0.31 = 1.52

6월 1일 : 1.52 + 0.01 = 1.53
6월 30일 : 1.52 + 0.30 = 1.82

7월 1일 : 1.82 + 0.01 = 1.83
7월 31일 : 1.82 + 0.31 = 2.13

8월 1일 : 2.13 + 0.01 = 2.14
8월 31일 : 2.13 + 0.31 = 2.44

9월 1일 : 2.44 + 0.01 = 2.45
9월 30일 : 2.44 + 0.30 = 2.74

10월 1일 : 2.74 + 0.01 = 2.75
10월 31일 : 2.74 + 0.31 = 3.05

11월 1일 : 3.05 + 0.01 = 3.06
11월 30일 : 3.05 + 0.30 = 3.35

12월 1일 : 3.35 + 0.01 = 3.36
12월 31일 : 3.35 + 0.31 = 3.66
```

이에 따라 dictionary 생성<br>
(Switch-case 와 같은 느낌으로 활용하기 위해)

```s
{
    1 : 0.00,
    2 : 0.31,
    3 : 0.60,
    4 : 0.91,
    5 : 1.21,
    6 : 1.52,
    7 : 1.82,
    8 : 2.13,
    9 : 2.44,
    10 : 2.74,
    11 : 3.05,
    12 : 3.35
}
```

일단 급하니까 먼저 다 만들고 써놔야겠다..